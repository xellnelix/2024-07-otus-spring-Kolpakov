databaseChangeLog:
  - changeSet:
      id: 2025-02-15--2--1
      author: xellnelix
      createSequence:
        schemaName: data
        sequenceName: transactions_seq_id
  - changeSet:
      id: 2025-02-15--2--2
      author: xellnelix
      changes:
        - sql:
            sql: "CREATE TYPE data.transaction_type AS ENUM ('INCOME', 'EXPENSE')"
            rollback:
              sql: "DROP TYPE data.transaction_type"
  - changeSet:
      id: 2025-02-15--2--3
      author: xellnelix
      createTable:
        schemaName: data
        tableName: transactions
        columns:
          - column:
              name: id
              type: bigint
              defaultValueComputed: "nextval('data.transactions_seq_id')"
              constraints:
                nullable: false
                primaryKey: true
                primaryKeyName: pk_transaction_id
          - column:
              name: account_id
              type: bigint
              constraints:
                nullable: false
                foreignKeyName: transactions_account_id_fk
                referencedTableSchemaName: data
                referencedTableName: accounts
                referencedColumnNames: id
                deleteCascade: true
          - column:
              name: type
              type: data.transaction_type
          - column:
              name: category_id
              type: smallint
          - column:
              name: amount
              type: numeric(12,2)
          - column:
              name: date
              type: timestamp
  - changeSet:
      id: 2025-02-15--2--4
      author: xellnelix
      changes:
        - addForeignKeyConstraint:
            baseTableSchemaName: data
            baseTableName: transactions
            baseColumnNames: category_id
            constraintName: transactions_category_id_fk
            onDelete: SET NULL
            onUpdate: CASCADE
            referencedTableSchemaName: data
            referencedTableName: categories
            referencedColumnNames: id